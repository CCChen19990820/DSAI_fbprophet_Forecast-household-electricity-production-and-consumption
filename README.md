# DSAI-HW3-_Forecast-household-electricity-production-and-consumption

## 題目流程
![螢幕擷取畫面 2022-06-05 182926](https://user-images.githubusercontent.com/48405514/172046264-adf99aa2-a01d-4e57-9a03-cffbf135e2e3.png)

程式會讀取家庭7天的comsumption.csv以及generation.csv檔案並給出未來一天的家庭用電量以及產電量的預測，並將預測出的結果做出未來一天每個小時要買還是賣的決策，平台媒合後所得到的結果會存在bidresult.csv當中，可輔助做下一次的預測。而目的是要盡可能的花費最少的電費，電費的計算方式如下圖:
![截圖 2022-05-10 下午11 35 09](https://user-images.githubusercontent.com/48405514/172046424-9d3c1e87-e334-4b4f-bdd7-3a1ee25ffcb2.png)

## 預測方法
本組總共採用三種方法做預測，分別使用了fbprophet模型、LSTM模型、以及7天均值三種方法，方法敘述如下列:

### 1.fbprophet
使用prophet分別對comsumption.csv以及generation.csv中的time轉換為ds，要預測的電量單位轉換為y，以餵入模型進行分析，並預測未來24個小時的(產/用)電量，預測的結果如下圖，圖一為用電量預測，圖二為產電量預測。
![con](https://user-images.githubusercontent.com/48405514/172047287-d761dd3a-9229-4e1b-a40c-586c5c37e64b.png)
(圖一)
![gen](https://user-images.githubusercontent.com/48405514/172047288-afb51ca0-27ea-452f-a7d4-d1feaac23972.png)
(圖二)
預測結果鰻擬合實際結果，但由於媒合平台無法安裝prophet套件，因而沒有採用。

### 2.LSTM
使用LSTM分別對comsumption.csv以及generation.csv做分析，並給出未來24小時的產、用電預測，預測出的電量起伏大致與實際的起伏波型一致，但預測出的波型起伏較實際值大上許多，因此在買賣策略上會超買、超賣實際應該買、賣的電量，效果也不佳，因次沒有採用。

### 3.Mean
在前兩個模型資料前處理時，有計算了資料及當中數據的特性，其中在7日平均值時發現，家庭用電量以及產電量大致是呈現週期性的，以及每日的用電量以及產電量也是呈現類週期性，例如家庭產電量在傍晚至隔日清晨是無產電的，因為沒有陽光，所以太陽能不會產電，相反的，在白天時太陽能會大量產電；用電量則是會依照不童家庭有不同的用電規律，偶爾會有異常用電的離群值。因此綜觀這些數據的週期性，將七日的每小時用電、產電量取平均值，作為預測下一日的用電產電量結果，平均值的結果相較於prophet稍微差了一點，比LSTM模型好了一點，也不需要訓練模型，因此採用此方法作為最後上傳的策略，並搭配下方買賣策略。若prophet能在平台執行，預測結果會更接近真實電量。

### 買賣策略
將產電與用電的預測結果相減即為要購買或賣出的電量，因平台規定若超賣則會用2.5元/度的電費從台電買進再賣出，因此將產、用電相減的結果除以2，分別以2元/度以及2.5元/度的價格進行買或賣，用低於台電電費的價格去買賣，以減少電費單花費。
